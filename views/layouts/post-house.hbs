<html lang="en">

<head>
    <meta charset="UTF-8" />
    <title>Trọ tốt</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-rbsA2VBKQhggwzxH7pPCaAqO46MgnOM80zW1RWuH61DGLwZJEdK2Kadq2F9CUG65" crossorigin="anonymous" />
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.15.4/css/all.css"
        integrity="sha384-DyZ88mC6Up2uqS4h/KRgHuoeGwBcD4Ng9SiP4dIRy0EXTlnuz47vAwmeGwVChigm" crossorigin="anonymous" />
    <link rel="stylesheet" type="text/css" href="../../public/assets/css/post-house.css" />
</head>

<body>
    <div class="container-fluid post-house">
        <nav class="navbar navbar-expand-lg navbar-light border-bottom header">
            <div class="container-fluid">
                <a href="/">
                    <img src="../../public/assets/pictures/icon.png" alt="" width="100px">
                </a>

                <div class="collapse navbar-collapse" id="navbarNavAltMarkup">
                    <div class="navbar-nav">
                        <a class="nav-link header__item mx-4" href="/">Trang chủ</a>
                        <a class="nav-link header__item mx-4" href="#">Phòng trọ nổi bật</a>
                        <a class="nav-link header__item mx-4" href="#">Liên hệ</a>
                    </div>
                </div>
                <div class="text-end user-option">

                    <ul class="text-white ms-2 nav-profile">
                        <li class="js-option-profile" onmouseover="hoverAva()">
                            <div class="text-center">
                                <img src="https://khoinguonsangtao.vn/wp-content/uploads/2022/07/avatar-cute-2.jpg"
                                    alt="">
                            </div>

                            <div>
                                Hân Mai
                                <i class="fas fa-sort-down"></i>
                            </div>

                            <ul class="subnav text-black js-subnav">
                                <li><a href="#">Tài khoản của tôi</a></li>
                                <li><a href="#">Đăng tin</a></li>
                                <li><a href="#">Đăng xuất</a></li>
                            </ul>
                        </li>

                    </ul>
                </div>
            </div>
        </nav>

        <nav id="sidebarMenu" class="collapse d-lg-block sidebar collapse bg-white">
            <div class="position-sticky">
                <div class="list-group list-group-flush mx-3 mt-4">
                    <a href="#" class="list-group-item list-group-item-action py-3 ripple">
                        <i class="fas fa-sticky-note fa-fw me-3"></i><span>Quản lý tin đăng</span>
                    </a>
                    <a href="#" class="list-group-item list-group-item-action py-3 ripple">
                        <i class="fas fa-clipboard fa-fw me-3"></i></i><span>Quản lý lịch xem phòng</span>
                    </a>
                    <a href="#" class="list-group-item list-group-item-action py-3 ripple">
                        <i class="fas fa-user-edit fa-fw me-3"></i><span>Thông tin cá nhân</span></a>
                    <a href="#" class="list-group-item list-group-item-action py-3 ripple">
                        <i class="fas fa-key fa-fw me-3"></i><span>Đổi mật khẩu</span></a>
                    <a href="#" class="list-group-item list-group-item-action py-3 ripple">
                        <i class="fas fa-sign-out-alt fa-fw me-3"></i><span>Đăng xuất</span>
                    </a>
                </div>
            </div>
        </nav>

        <div class="content">
            <div class="content__header mt-4 pb-3 border-bottom">
                <h5>ĐĂNG TIN NHÀ TRỌ</h5>
            </div>
            <form action="/house/add-house" method="post" enctype="multipart/form-data">
                <div class="mt-4 pb-2">
                    <h6>ĐỊA CHỈ CHO THUÊ</h6>
                </div>
                <div class="d-flex justify-content-between content__address">
                    <div class="address-item">
                        <div class="text-center mb-2">
                            <label for="city-select">Tỉnh/Thành phố<span style="color:red">*</span></label>
                        </div>
                        <select required name="cities" id="city-select" onfocus='this.size=5;' onblur='this.size=1;'
                            onchange='this.size=1; this.blur();'>
                            <option class="text-center" value="">--Chọn Tỉnh/TP--</option>
                            <option value="dog">Hồ Chí Minh</option>
                            <option value="cat">Đà Nẵng</option>
                            <option value="hamster">Huế</option>
                            <option value="parrot">Hà Nội</option>
                            <option value="spider">Thái Nguyên</option>
                            <option value="goldfish">Kiên Giang</option>
                        </select>
                        <div class="text-center text-danger content__note" id="note1">
                            Vui lòng chọn
                        </div>
                    </div>
                    <div class="address-item">
                        <div class="text-center mb-2">
                            <label for="district-select">Quận/Huyện<span style="color:red">*</span></label>
                        </div>
                        <select required name="districts" id="district-select" onfocus='this.size=5;'
                            onblur='this.size=1;' onchange='this.size=1; this.blur();'>
                            <option class="text-center" value="">--Chọn Quận/Huyện--</option>
                            <option value="dog">Quận 1</option>
                            <option value="cat">Quận 2</option>
                            <option value="hamster">Quận 3</option>
                            <option value="parrot">Quận 4</option>
                            <option value="spider">Quận 5</option>
                            <option value="goldfish">Quận 6</option>
                        </select>
                        <div class="text-center text-danger content__note" id="note2">
                            Vui lòng chọn
                        </div>
                    </div>
                    <div class="address-item">
                        <div class="text-center mb-2">
                            <label for="ward-select">Phường/Xã<span style="color:red">*</span></label>
                        </div>
                        <select required name="wards" id="ward-select" onfocus='this.size=5;' onblur='this.size=1;'
                            onchange='this.size=1; this.blur();'>
                            <option class="text-center" value="">--Chọn Phường/Xã--</option>
                            <option value="dog">Phường 1</option>
                            <option value="cat">Phường 2</option>
                            <option value="hamster">Phường 3</option>
                            <option value="parrot">Phường 4</option>
                            <option value="spider">Phường 5</option>
                            <option value="goldfish">Phường 6</option>
                        </select>
                        <div class="text-center text-danger content__note" id="note3">
                            Vui lòng chọn
                        </div>
                    </div>
                </div>
                <div class="mt-4">
                    <label class="d-block mb-2" for="detailed-address">Địa chỉ cụ thể<span
                            style="color:red">*</span></label>
                    <input type="text" id="detailed-address" name="detailed_address"
                        placeholder="Nhập số nhà, tên đường" value="" required>
                    <div class="text-center text-danger content__note" id="detailed-address-note">
                        Vui lòng chọn
                    </div>
                </div>
                <div class="mt-4 pb-2">
                    <h6>THÔNG TIN NHÀ TRỌ</h6>
                </div>
                <div>
                    <label class="d-block mb-2" for="title">Tiêu đề<span style="color:red">*</span></label>
                    <input type="text" id="title" name="title" placeholder="Nhập tiêu đề tin đăng nhà trọ" value=""
                        required>
                    <div class="text-center text-danger content__note" id="title-note">
                        Vui lòng chọn
                    </div>
                </div>
                <div class="mt-4 pb-2">
                    <label class="d-block mb-2" for="description">Nội dung mô tả<span style="color:red">*</span></label>
                    <textarea id="description" name="description" rows="6"></textarea>
                    <div class="text-center text-danger content__note" id="description-note">
                        Vui lòng chọn
                    </div>
                </div>
                <div class="content__utility">
                    <div class="mt-4">
                        <div class="mb-2 ">
                            <label for="utility-select">Tiện ích (Ít nhất 1 tiện ích)<span
                                    style="color:red">*</span></label>
                        </div>
                        <select required name="utilities" id="utility-select" placeholder="Bấm vào để chọn tiện ích"
                            multiple>
                            {{!-- <option class="text-center" value="">--Chọn Tiện ích--</option> --}}
                            <option value="dog">Wifi</option>
                            <option value="cat">Tivi</option>
                            <option value="hamster">Tủ lạnh</option>
                            <option value="parrot">Bếp</option>
                            <option value="spider">Bãi xe</option>
                            <option value="goldfish">Thú cưng</option>
                        </select>
                        <div class="text-center text-danger content__note" id="note4">
                            Vui lòng chọn
                        </div>
                    </div>

                </div>
                <div class="d-flex justify-content-between">
                    <div class="mt-4 content__area">
                        <label class="d-block mb-2" for="area">Diện tích<span style="color:red">*</span></label>
                        <input type="number" id="area" name="are" placeholder="Nhập diện tích trọ" value="" required>
                        <div class="text-center text-danger content__note" id="area-note">
                            Vui lòng chọn
                        </div>
                    </div>
                    <div class="mt-4 content__people">
                        <label class="d-block mb-2" for="num_people">Số người<span style="color:red">*</span></label>
                        <input type="number" min="1" id="num_people" name="num_people" placeholder="Số người ở" value=""
                            required>
                        <div class="text-center text-danger content__note" id="note5">
                            Vui lòng chọn
                        </div>
                    </div>
                </div>

                <div class="d-flex justify-content-between content__prices">
                    <div class="mt-4">
                        <label class="d-block mb-2" for="price">Giá cho thuê<span style="color:red">*</span></label>
                        <input type="number" id="price" name="price" placeholder="Nhập giá nhà trọ" value="" required>
                        <div class="text-center text-danger content__note" id="price-note">
                            Vui lòng chọn
                        </div>
                    </div>
                    <div class="mt-4">
                        <label class="d-block mb-2" for="water">Tiền nước (Nếu có)</label>
                        <input type="number" id="water" name="water" placeholder="Nhập tiền nước" value="">
                    </div>
                    <div class="mt-4">
                        <label class="d-block mb-2" for="electricity">Tiền điện (Nếu có)</label>
                        <input type="number" id="electricity" name="electricity" placeholder="Nhập tiền điện" value="">
                    </div>
                </div>
                <div class="mt-4 pb-2">
                    <h6>HÌNH ẢNH/VIDEO</h6>
                </div>
                <div class="content__files d-flex flex-wrap" id="drop_zone"
                    ondrop="dropHandler(event);" ondragover="dragOverHandler(event);">
                    <div>Kéo thả ảnh/video vào đây</div>
                </div>
                <div class="content__btn-add-file text-center">
                    <input type="file" id="house-file" name="upload-house-file" hidden multiple>
                    <div class="mt-3 d-flex justify-content-center align-items-center">
                        <label for="house-file">Upload Ảnh/Video</label>
                        <i class="fas fa-upload mx-2"></i>
                    </div>
                </div>
                <div class="btn-submit mt-4">
                    <input id="js-btn-submit" type="submit" value="XÁC NHẬN">
                </div>

            </form>
        </div>
    </div>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/bbbootstrap/libraries@main/choices.min.css">
    <script src="https://cdn.jsdelivr.net/gh/bbbootstrap/libraries@main/choices.min.js"></script>
    <script src="https://code.jquery.com/jquery-3.6.1.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-kenU1KFdBIe4zVF0s0G1M5b4hcpxyD9F7jL+jjXkk+Q2h455rYXK/7HAuoJl+0I4"
        crossorigin="anonymous"></script>
</body>
<script type="text/javascript">
    let imagesArray = [];
    const fileUploader = document.getElementById('house-file');
    const reader = new FileReader();
    const outputFiles = document.querySelector('.content__files')
    const imageGrid = document.getElementById('profile-ava');
    const citySelect = document.getElementById('city-select');
    const districtSelect = document.getElementById('district-select');
    const wardSelect = document.getElementById('ward-select');
    const detailAddress = document.getElementById('detailed-address');
    const title = document.getElementById('title');
    const description = document.getElementById('description');
    const price = document.getElementById('price');
    const num_people = document.getElementById('num_people');
    const area = document.getElementById('area');
    const utilitySelect = document.getElementById('utility-select');

    $(document).ready(function () {

        let multipleCancelButton = new Choices('#utility-select', {
            removeItemButton: true,
            maxItemCount: 10,
            searchResultLimit: 5,
            renderChoiceLimit: 5
        });
    });
    function dropHandler(event) {
        event.preventDefault();

        const dt = new DataTransfer();
        if (imagesArray.length >= 10) {
            alert("Bạn chỉ có thể tải tối đa 10 files:(");
        }
        else {
            [...event.dataTransfer.files].forEach((file, i) => {
                if (imagesArray.length < 10)
                    imagesArray.push(file)
            });
            for (let i = 0; i < imagesArray.length; i++) {
                const file = imagesArray[i]
                dt.items.add(file)
            }

            fileUploader.files = dt.files;
            displayImages()
            
        }
    }
    function dragOverHandler(ev) {
        console.log("File(s) in drop zone");

        // Prevent default behavior (Prevent file from being opened)
        ev.preventDefault();
    }
    utilitySelect.addEventListener('change', function (event) {
        const val = utilitySelect.options[utilitySelect.selectedIndex].value;

        if (val == "") {
            let note = document.getElementById('note4');
            note.style.display = 'block';
        }
        else {
            let note = document.getElementById('note4');
            note.style.display = 'none';
        }
    })
    detailAddress.addEventListener('change', function (event) {
        const val = detailAddress.value;

        if (val == "") {
            let note = document.getElementById('detailed-address-note');
            note.style.display = 'block';
            let btn = document.getElementById('js-btn-submit');
        }
        else {
            let note = document.getElementById('detailed-address-note');
            note.style.display = 'none';
        }
    })
    description.addEventListener('change', function (event) {
        const val = description.value;

        if (val == "") {
            let note = document.getElementById('description-note');
            note.style.display = 'block';
        }
        else {
            let note = document.getElementById('description-note');
            note.style.display = 'none';
        }
    })
    price.addEventListener('change', function (event) {
        const val = price.value;

        if (val == "") {
            let note = document.getElementById('price-note');
            note.style.display = 'block';
        }
        else {
            let note = document.getElementById('price-note');
            note.style.display = 'none';
        }
    })
    num_people.addEventListener('change', function (event) {
        const val = num_people.value;

        if (val == "") {
            let note = document.getElementById('note5');
            note.style.display = 'block';
        }
        else {
            let note = document.getElementById('note5');
            note.style.display = 'none';
        }
    })
    area.addEventListener('change', function (event) {
        const val = area.value;

        if (val == "") {
            let note = document.getElementById('area');
            note.style.display = 'block';
        }
        else {
            let note = document.getElementById('area');
            note.style.display = 'none';
        }
    })
    citySelect.addEventListener('change', function (event) {
        const val = citySelect.options[citySelect.selectedIndex].value;

        if (val == "") {
            let note = document.getElementById('note1');
            note.style.display = 'block';
        }
        else {
            let note = document.getElementById('note1');
            note.style.display = 'none';
        }
    })
    districtSelect.addEventListener('change', function (event) {
        const val = districtSelect.options[districtSelect.selectedIndex].value;

        if (val == "") {
            let note = document.getElementById('note2');
            note.style.display = 'block';
        }
        else {
            let note = document.getElementById('note2');
            note.style.display = 'none';
        }
    })
    wardSelect.addEventListener('change', function (event) {
        const val = wardSelect.options[wardSelect.selectedIndex].value;

        if (val == "") {
            let note = document.getElementById('note3');
            note.style.display = 'block';
        }
        else {
            let note = document.getElementById('note3');
            note.style.display = 'none';
        }
    })
    fileUploader.addEventListener('change', function (event) {
        console.log(event.target.files)
        const files = event.target.files;
        const dt = new DataTransfer();

        console.log(files)
        if (imagesArray.length >= 10) {
            alert("Bạn chỉ có thể tải tối đa 10 files:(");
        }
        else {
            for (let i = 0; i < files.length; i++) {
                if (imagesArray.length < 10)
                    imagesArray.push(files[i])
            }
            for (let i = 0; i < imagesArray.length; i++) {
                const file = imagesArray[i]
                dt.items.add(file) // here you exclude the file. thus removing it.
            }

            event.target.files = dt.files
            displayImages()
        }

    });
    function displayImages() {
        let images = ""
        imagesArray.forEach((file, index) => {
            const fileType = file.type;
            if (fileType.startsWith('image/')) {
                images += `<div class="image">
                <img src="${URL.createObjectURL(file)}" alt="image">
                <span onclick="deleteImage(${index})">&times;</span>
              </div>`
            } else if (fileType.startsWith('video/')) {
                images += `<div class="image">
                <video controls="controls" src="${URL.createObjectURL(file)}" type="video/mp4"></video>
                <span onclick="deleteImage(${index})">&times;</span>
              </div>`
            }

        })
        outputFiles.innerHTML = images
    }
    function hoverAva() {
        let modalProfile = document.querySelector('.js-option-profile');
        let subnav = document.querySelector('.js-subnav');
        console.log(modalProfile, subnav)
        const openProfileOptions = function () {
            subnav.classList.add('open');
        }
        const closeProfileOptions = function () {
            subnav.classList.remove('open');
        }

        modalProfile.addEventListener('mouseover', openProfileOptions);
        modalProfile.addEventListener('mouseout', closeProfileOptions);
    }
</script>

</html>